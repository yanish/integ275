install.packages("igraph")
install.packages("network")
install.packages("ggplot2")
install.packages("ndtv")
library(igraph)
library(network)
library(ggplot2)
library(statnet)
library(ndtv)
setwd("/Users/rachelwood/Documents/integ275")
dat <- read.csv("Data/FinalAdjacencyMatrix.csv")
att <- read.csv("Data/EnronEmployeeInformation.csv")
View(att)
matrix <- as.matrix(read.csv("Data/FinalAdjacencyMatrix.csv", sep=",", header=TRUE, row.names=1))
network <- graph.adjacency(matrix,weighted=TRUE)
network <- simplify(network, remove.multiple = FALSE, remove.loops = TRUE)
V(network)$degree <- igraph::degree(network, v = V(network), mode = c("all"))
V(network)$gender <- as.character(att$Sex)#as.character needed to keep attribute in string format
V(network)$sex <- att$Sex
V(network)$id <- att$ID
V(network)$dept <- as.character(att$Department)
V(network)$department <- att$Department
V(network)$email <- as.character(att$EmailID)
V(network)$title <- as.character(att$Title)
V(network)$betweenness <- centralization.betweenness(network)$res
V(network)$eigen <- eigen_centrality(network, directed = TRUE)$vector
colrs <- c("orange2", "sky blue2")
V(network)$color <- colrs[V(network)$sex]
data_df <- data.frame(V(network)$id,
V(network)$name,
V(network)$gender,
V(network)$dept,
V(network)$title,
V(network)$email,
V(network)$degree,
V(network)$betweenness,
V(network)$eigen)
colnames(data_df) <- c("User_ID",
"Name",
"Gender",
"Department",
"Title",
"E-mail",
"Degree",
"Betweenness_Centrality",
"Eigenvector_Centrality")
comdet <- cluster_louvain(net.undir)
net.undir <- simplify(network, remove.multiple = FALSE, remove.loops = TRUE)
comdet <- cluster_louvain(net.undir)
len <- length(comdet) # how many are there
comdet <- cluster_louvain(net.undir)
net.undir <- simplify(network, remove.multiple = FALSE, remove.loops = TRUE)
comdet <- cluster_louvain(net.undir)
net.undir <- as.undirected(network)
net.undir <- simplify(network, remove.multiple = FALSE, remove.loops = TRUE)
comdet <- cluster_louvain(net.undir)
net.undir <- simplify(net.undir, remove.multiple = FALSE, remove.loops = TRUE)
comdet <- cluster_louvain(net.undir)
net.undir <- simplify(network, remove.multiple = FALSE, remove.loops = TRUE)
Memb_df <- data.frame(V(net.undir)$id,
V(net.undir)$name,
V(net.undir)$gender,
V(net.undir)$dept,
V(net.undir)$title,
V(net.undir)$membership)
memb <- membership(comdet)
comdet <- cluster_louvain(net.undir)
net.undir <- as.undirected(network)
comdet <- cluster_louvain(net.undir)
len <- length(comdet) # how many are there
lou_size <- sizes(comdet) # how many inside each?
memb <- membership(comdet)
V(net.undir)$membership <- memb
ls.df <- as.data.frame(lou_size) # make it a dataframe
colnames(ls.df) <- c("Community_ID", "Num_Nodes") # fix the column names
View(ls.df) # take a peak
Memb_df <- data.frame(V(net.undir)$id,
V(net.undir)$name,
V(net.undir)$gender,
V(net.undir)$dept,
V(net.undir)$title,
V(net.undir)$membership)
colnames(Memb_df) <- c("User_ID",
"Name",
"Gender",
"Department",
"Title",
"Community_ID")
View(Memb_df)
write.csv(data_df, "Data/Membership_dat.csv")
write.csv(Memb_df, "Data/Com_Membership.csv")
