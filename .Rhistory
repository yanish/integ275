<<<<<<< Updated upstream
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$eigen > 4.8e-02, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$eigen > 4.8e-02, 15, 4),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Eigenvector",
frame = T)
par(mfrow=c(1,3), oma=c(0,0,0.5,0))
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$degree > 45, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$degree > 45, V(network)$degree*0.2, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main= "Degree",
frame = T)
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.color = ifelse(V(network)$betweenness > 750, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$betweenness > 750, V(network)$betweenness*0.015, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Betweenness",
frame = T)
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$eigen > 4.8e-02, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$eigen > 4.8e-02, 15, 4),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Eigenvector",
frame = T)
par(mfrow=c(1,3), oma=c(0,0,0.5,0), mar=c(0,0,1,0))
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$degree > 45, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$degree > 45, V(network)$degree*0.2, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main= "Degree",
frame = T)
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.color = ifelse(V(network)$betweenness > 750, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$betweenness > 750, V(network)$betweenness*0.015, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Betweenness",
frame = T)
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$eigen > 4.8e-02, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$eigen > 4.8e-02, 15, 4),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Eigenvector",
frame = T)
par(mfrow=c(1,3), oma=c(0,0,0.5,0), mar=c(0,0,-1,0))
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$degree > 45, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$degree > 45, V(network)$degree*0.2, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main= "Degree",
frame = T)
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.color = ifelse(V(network)$betweenness > 750, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$betweenness > 750, V(network)$betweenness*0.015, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Betweenness",
frame = T)
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$eigen > 4.8e-02, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$eigen > 4.8e-02, 15, 4),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Eigenvector",
frame = T)
par(mfrow=c(1,3), oma=c(0,0,-1,0), mar=c(0,0,-1,0))
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$degree > 45, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$degree > 45, V(network)$degree*0.2, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main= "Degree",
frame = T)
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.color = ifelse(V(network)$betweenness > 750, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$betweenness > 750, V(network)$betweenness*0.015, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Betweenness",
frame = T)
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$eigen > 4.8e-02, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$eigen > 4.8e-02, 15, 4),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Eigenvector",
frame = T)
pdf("plots/Centrality_measures_top_10.pdf")
par(mfrow=c(1,3), oma=c(0,0,-1,0), mar=c(0,0,-1,0))
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$degree > 45, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$degree > 45, V(network)$degree*0.2, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main= "Degree",
frame = T)
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.color = ifelse(V(network)$betweenness > 750, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$betweenness > 750, V(network)$betweenness*0.015, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Betweenness",
frame = T)
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$eigen > 4.8e-02, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$eigen > 4.8e-02, 15, 4),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Eigenvector",
frame = T)
dev.off()
par(mfrow=c(1,3), oma=c(0,0,0,0), mar=c(0,0,0,0))
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$degree > 45, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$degree > 45, V(network)$degree*0.2, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main= "Degree",
frame = T)
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.color = ifelse(V(network)$betweenness > 750, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$betweenness > 750, V(network)$betweenness*0.015, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Betweenness",
frame = T)
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$eigen > 4.8e-02, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$eigen > 4.8e-02, 15, 4),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Eigenvector",
frame = T)
dev.off()
pdf("plots/Centrality_measures_top_10.pdf")
par(mfrow=c(1,3), oma=c(0,0,0.5,0), mar=c(0,0,0.5,0))
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$degree > 45, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$degree > 45, V(network)$degree*0.2, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main= "Degree",
frame = T)
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.color = ifelse(V(network)$betweenness > 750, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$betweenness > 750, V(network)$betweenness*0.015, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Betweenness",
frame = T)
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$eigen > 4.8e-02, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$eigen > 4.8e-02, 15, 4),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Eigenvector",
frame = T)
dev.off()
pdf("plots/Centrality_measures_top_10.pdf")
par(mfrow=c(1,3))
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$degree > 45, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$degree > 45, V(network)$degree*0.2, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main= "Degree",
frame = T)
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.color = ifelse(V(network)$betweenness > 750, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$betweenness > 750, V(network)$betweenness*0.015, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Betweenness",
frame = T)
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$eigen > 4.8e-02, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$eigen > 4.8e-02, 15, 4),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Eigenvector",
frame = T)
dev.off()
pdf("plots/Centrality_measures_top_10.pdf")
par(mfrow=c(1,3), mar=c(0,0,0,0))
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$degree > 45, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$degree > 45, V(network)$degree*0.2, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main= "Degree",
frame = F)
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.color = ifelse(V(network)$betweenness > 750, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$betweenness > 750, V(network)$betweenness*0.015, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Betweenness",
frame = F)
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$eigen > 4.8e-02, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$eigen > 4.8e-02, 15, 4),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Eigenvector",
frame = F)
dev.off()
pdf("plots/Centrality_measures_top_10.pdf")
par(mfrow=c(1,3), mar=c(0,0,1,0))
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$degree > 45, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$degree > 45, V(network)$degree*0.2, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main= "Degree",
frame = F)
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.color = ifelse(V(network)$betweenness > 750, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$betweenness > 750, V(network)$betweenness*0.015, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Betweenness",
frame = F)
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$eigen > 4.8e-02, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$eigen > 4.8e-02, 15, 4),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Eigenvector",
frame = F)
dev.off()
pdf("plots/Centrality_measures_top_10.pdf")
par(mfrow=c(1,3), mar=c(0,0,1.5,0))
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$degree > 45, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$degree > 45, V(network)$degree*0.2, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main= "Degree",
frame = F)
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.color = ifelse(V(network)$betweenness > 750, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$betweenness > 750, V(network)$betweenness*0.015, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Betweenness",
frame = F)
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$eigen > 4.8e-02, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$eigen > 4.8e-02, 15, 4),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Eigenvector",
frame = F)
dev.off()
plot(network,
rescale = F,
layout = lay2*0.5,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$degree > 45, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$degree > 45, V(network)$degree*0.2, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main= "Degree",
frame = F)
par(mar=c(0,0,0,0)+0.1)
plot(network,
rescale = F,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$degree > 45, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$degree > 45, V(network)$degree*0.2, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main= "Degree",
frame = F)
plot(network,
rescale = FALSE,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$degree > 45, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$degree > 45, V(network)$degree*0.2, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main= "Degree",
frame = T)
set.seed(875)
par(mar=c(0,0,0,0)+0.1)
plot(network,
rescale = FALSE,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$degree > 45, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$degree > 45, V(network)$degree*0.2, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main= "Degree",
frame = T)
par(mfrow=c(1,3), mar=c(0,0,1.5,0))
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$degree > 45, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$degree > 45, V(network)$degree*0.2, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main= "Degree",
frame = T)
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.color = ifelse(V(network)$betweenness > 750, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$betweenness > 750, V(network)$betweenness*0.015, 3),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Betweenness",
frame = F)
plot(network,
layout = lay2,
vertex.label = NA,
vertex.label.color = "black",
vertex.label.cex = 0.8,
vertex.color = ifelse(V(network)$eigen > 4.8e-02, V(network)$color, "slate grey"),
vertex.frame.color = "white",
vertex.size = ifelse(V(network)$eigen > 4.8e-02, 15, 4),
edge.arrow.size = 0.3,
edge.color = "grey",
main="Eigenvector",
frame = F)
=======
install.packages("igraph")
install.packages("igraph")
install.packages("network")
install.packages("ggplot2")
install.packages("ndtv")
library(igraph)
library(network)
library(ggplot2)
library(statnet)
library(ndtv)
setwd("/Users/rachelwood/Documents/integ275")
dat <- read.csv("Data/FinalAdjacencyMatrix.csv")
View(att)
att <- read.csv("Data/EnronEmployeeInformation.csv")
View(att)
matrix <- as.matrix(read.csv("Data/FinalAdjacencyMatrix.csv", sep=",", header=TRUE, row.names=1))
network <- graph.adjacency(matrix,weighted=TRUE)
network <- simplify(network, remove.multiple = FALSE, remove.loops = TRUE)
V(network)$degree <- igraph::degree(network, v = V(network), mode = c("all"))
V(network)$gender <- as.character(att$Sex)#as.character needed to keep attribute in string format
V(network)$sex <- att$Sex
V(network)$id <- att$ID
V(network)$dept <- as.character(att$Department)
library(igraph)
V(network)$degree <- igraph::degree(network, v = V(network), mode = c("all"))
V(network)$gender <- as.character(att$Sex)#as.character needed to keep attribute in string format
V(network)$sex <- att$Sex
V(network)$id <- att$ID
V(network)$dept <- as.character(att$Department)
V(network)$department <- att$Department
V(network)$email <- as.character(att$EmailID)
V(network)$title <- as.character(att$Title)
V(network)$betweenness <- centralization.betweenness(network)$res
V(network)$eigen <- eigen_centrality(network, directed = TRUE)$vector
data_df <- data.frame(V(network)$id,
V(network)$name,
V(network)$gender,
V(network)$dept,
V(network)$title,
V(network)$email,
V(network)$degree,
V(network)$betweenness,
V(network)$eigen)
colnames(data_df) <- c("User_ID",
"Name",
"Gender",
"Department",
"Title",
"E-mail",
"Degree",
"Betweenness_Centrality",
"Eigenvector_Centrality")
View(data_df)
V(network)$title)
degree_df <- data.frame(V(network)$degree,
V(network)$name,
V(network)$gender,
V(network)$dept,
V(network)$title)
colnames(degree_df) <- c("Degree",
"Name",
"Gender",
"Department",
"Title")
View(degree_df)
between_df <- data.frame(V(network)$betweenness,
V(network)$name,
V(network)$gender,
V(network)$dept,
V(network)$title)
colnames(between_df) <- c("Betweenness Centrality",
"Name",
"Gender",
"Department",
"Title")
View(between_df)
eigen_df <- data.frame(V(network)$eigen,
V(network)$name,
V(network)$gender,
V(network)$dept,
V(network)$title)
colnames(eigen_df) <- c("Eigenvector Centrality",
"Name",
"Gender",
"Department",
"Title")
View(eigen_df)
install.packages("igraph")
install.packages("network")
install.packages("ggplot2")
install.packages("ndtv")
library(igraph)
library(network)
library(ggplot2)
install.packages("igraph")
library(ndtv)
library(statnet)
setwd("/Users/rachelwood/Documents/integ275")
dat <- read.csv("Data/FinalAdjacencyMatrix.csv")
att <- read.csv("Data/EnronEmployeeInformation.csv")
matrix <- as.matrix(read.csv("Data/FinalAdjacencyMatrix.csv", sep=",", header=TRUE, row.names=1))
install.packages("igraph")
dat <- read.csv("Data/FinalAdjacencyMatrix.csv")
att <- read.csv("Data/EnronEmployeeInformation.csv")
library(network)
matrix <- as.matrix(read.csv("Data/FinalAdjacencyMatrix.csv", sep=",", header=TRUE, row.names=1))
network <- graph.adjacency(matrix,weighted=TRUE)
network <- simplify(network, remove.multiple = FALSE, remove.loops = TRUE)
library(igraph)
library(network)
library(ggplot2)
library(statnet)
library(ndtv)
setwd("/Users/rachelwood/Documents/integ275")
dat <- read.csv("Data/FinalAdjacencyMatrix.csv")
att <- read.csv("Data/EnronEmployeeInformation.csv")
matrix <- as.matrix(read.csv("Data/FinalAdjacencyMatrix.csv", sep=",", header=TRUE, row.names=1))
network <- graph.adjacency(matrix,weighted=TRUE)
network <- simplify(network, remove.multiple = FALSE, remove.loops = TRUE)
V(network)$degree <- igraph::degree(network, v = V(network), mode = c("all"))
V(network)$gender <- as.character(att$Sex)#as.character needed to keep attribute in string format
V(network)$sex <- att$Sex
V(network)$id <- att$ID
V(network)$dept <- as.character(att$Department)
V(network)$department <- att$Department
V(network)$email <- as.character(att$EmailID)
V(network)$title <- as.character(att$Title)
V(network)$betweenness <- centralization.betweenness(network)$res
V(network)$eigen <- eigen_centrality(network, directed = TRUE)$vector
data_df <- data.frame(V(network)$id,
V(network)$name,
V(network)$gender,
V(network)$dept,
V(network)$title,
V(network)$email,
V(network)$degree,
V(network)$betweenness,
V(network)$eigen)
colnames(data_df) <- c("User_ID",
"Name",
"Gender",
"Department",
"Title",
"E-mail",
"Degree",
"Betweenness_Centrality",
"Eigenvector_Centrality")
write.csv(data_df, "Data/network_dat.csv")
>>>>>>> Stashed changes
