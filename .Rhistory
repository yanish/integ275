install.packages("igraph")
install.packages("network")
install.packages("ggplot2")
install.packages("ndtv")
library(igraph)
library(network)
library(ggplot2)
library(statnet)
library(ndtv)
setwd("/Users/rachelwood/Documents/integ275")
dat <- read.csv("Data/FinalAdjacencyMatrix.csv")
att <- read.csv("Data/EnronEmployeeInformation.csv")
matrix <- as.matrix(read.csv("Data/FinalAdjacencyMatrix.csv", sep=",", header=TRUE, row.names=1))
network <- graph.adjacency(matrix,weighted=TRUE)
network <- simplify(network, remove.multiple = FALSE, remove.loops = TRUE)
V(network)$degree <- igraph::degree(network, v = V(network), mode = c("all"))
V(network)$gender <- as.character(att$Sex)#as.character needed to keep attribute in string format
V(network)$sex <- att$Sex
V(network)$id <- att$ID
V(network)$dept <- as.character(att$Department)
V(network)$department <- att$Department
V(network)$email <- as.character(att$EmailID)
V(network)$title <- as.character(att$Title)
V(network)$betweenness <- centralization.betweenness(network)$res
V(network)$eigen <- eigen_centrality(network, directed = TRUE)$vector
colrs <- c("orange2", "sky blue2")
V(network)$color <- colrs[V(network)$sex]
net.undir <- as.undirected(network)
comdet <- cluster_louvain(net.undir)
lou_size <- sizes(comdet) # how many inside each?
memb <- membership(comdet)
V(net.undir)$membership <- memb
V(net.undir)$sizes <- lou_size
Memb_df <- data.frame(V(net.undir)$id,
V(net.undir)$name,
V(net.undir)$gender,
V(net.undir)$dept,
V(net.undir)$title,
V(net.undir)$membership,
V(network)$degree,
V(network)$betweenness,
V(network)$eigen)
write.csv(Memb_df, "Data/Membership_dat.csv")
Memb_df <- data.frame(V(net.undir)$id,
V(net.undir)$name,
V(net.undir)$gender,
V(net.undir)$dept,
V(net.undir)$title,
V(net.undir)$membership,
V(network)$degree,
V(network)$betweenness,
V(network)$eigen)
View(Memb_df)
write.csv(Memb_df, "Data/Com_Centrality.csv")
